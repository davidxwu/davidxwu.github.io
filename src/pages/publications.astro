---
import Layout from '../layouts/Layout.astro';
import { getPublicationsByYear, type Author } from '../data/publications';

const pubsByYear = getPublicationsByYear();

function formatAuthors(authors: Author[], equalContribution?: boolean) {
  return authors.map(a => {
    const isMe = a.name.includes('David X.');
    let formatted = isMe ? `<strong>${a.name}</strong>` : 
      (a.url ? `<a href="${a.url}" target="_blank">${a.name}</a>` : a.name);
    return equalContribution ? `${formatted}*` : formatted;
  }).join(', ');
}
---

<Layout title="Research | David X. Wu">
  <article>
    <h1>Research</h1>
    <p class="note">
      (*) denotes equal contribution, listed alphabetically as is customary in theoretical computer science.
    </p>

    {pubsByYear.map(([year, pubs]) => (
      <section>
        <h2 class="year">{year}</h2>
        <ul class="pubs">
          {pubs.map(pub => (
            <li>
              <span class="venue-tag">{pub.venueShort}</span>
              <span class="title">{pub.title}</span>
              <span class="authors" set:html={formatAuthors(pub.authors, pub.equalContribution)} />
              <span class="venue">{pub.venue}</span>
              {pub.arxiv && (
                <span class="links">
                  <a href={`https://arxiv.org/abs/${pub.arxiv}`} target="_blank">arXiv</a>
                </span>
              )}
            </li>
          ))}
        </ul>
      </section>
    ))}
  </article>
</Layout>

<style>
  h1 {
    margin-top: 0;
    margin-bottom: 1rem;
  }

  .note {
    font-size: 0.9rem;
    color: var(--text-muted);
    margin-bottom: 2rem;
  }

  section {
    margin-bottom: 2rem;
  }

  .year {
    font-family: var(--font-mono);
    font-size: 0.95rem;
    color: var(--text-muted);
    margin: 0 0 1rem;
    font-weight: 400;
  }

  .pubs {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .pubs li {
    margin-bottom: 1.5rem;
  }

  .venue-tag {
    display: inline-block;
    font-family: var(--font-mono);
    font-size: 0.72rem;
    padding: 0.15rem 0.45rem;
    background: var(--border);
    border-radius: 3px;
    margin-right: 0.5rem;
    font-weight: 500;
  }

  .title {
    font-weight: 500;
    display: block;
    margin-top: 0.25rem;
  }

  .authors {
    display: block;
    font-size: 0.92rem;
    color: var(--text-muted);
    margin-top: 0.2rem;
  }

  .venue {
    display: block;
    font-size: 0.88rem;
    font-style: italic;
    color: var(--text-muted);
    margin-top: 0.15rem;
  }

  .links {
    display: block;
    font-size: 0.85rem;
    margin-top: 0.35rem;
  }
</style>
